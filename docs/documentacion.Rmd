---
title: "Documentaci√≥n del Modelo SEIR"
author: "P√°ez & Ruiz"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
  html_document: default
---

## Introducci√≥n

El presente documento (en desarrollo) presenta la documentaci√≥n referida a la app "[Prototipo Tablero Epidemiol√≥gico SEIR - Argentina](https://druiz.shinyapps.io/proto_epi/)".

## üì¶ Estructura de la app Shiny

-   Modularizaci√≥n
    -   global.R: contiene las librer√≠as necesarias para la app, y las configuraciones iniciales del modelo (par√°metros epidemiol√≥gicos, simulaci√≥n de recursos, fechas de inicio y fin de la simulaci√≥n).
    -   mod_model.R: implementa la l√≥gica del modelo SEIR
    -   mod_server.R: define la l√≥gica del servidor de la aplicaci√≥n y orquesta los m√≥dulos de datos, modelo y visualizaci√≥n.
    -   mod_data.R: simula la ingesta de datos y proporciona un conjunto de datos estructurado para la utilizaci√≥n en el resto de los m√≥dulos.
    -   mod_viz.R: genera las visualizaciones interactivas.
    -   mod_ui.R: define la interfaz de usuario.

\

------------------------------------------------------------------------

## ‚öôÔ∏è Par√°metros Epidemiol√≥gicos

### Par√°metros base

| Par√°metro | Valor inicial | Fuente o justificaci√≥n | Decisi√≥n actual |
|----|----|----|----|
| Poblaci√≥n total | 45.000.000 | [Proyecciones de poblaci√≥n - INDEC](https://www.indec.gob.ar/indec/web/Nivel4-Tema-2-24-84) | Aproximado poblaci√≥n Argentina |
| R‚ÇÄ | 2,5 | IECS modelo base | Ajustable por UI |
| IFR | 0,01 | Valor global estimado | Ajustable por UI |
| Per√≠odo de incubaci√≥n | 5 d√≠as | CDC/OMS promedio | Ajustable por UI |
| Per√≠odo infeccioso | 7 d√≠as | Estudios cl√≠nicos | Ajustable por UI |

### üîÅ Opciones

#### R‚ÇÄ Din√°mico vs. Fijo

**R‚ÇÄ**, o n√∫mero b√°sico de reproducci√≥n, estima el n√∫mero promedio de infecciones generadas por una persona en el per√≠odo infeccioso. Puede utilizarse un valor estimado fijo (en este caso, 2.5) o bien, tal como ocurre en el modelo IECS, adoptar una f√≥rmula din√°mica que permita calcular en base a la evoluci√≥n de la incidencia de exposici√≥n.

[**F√≥rmula utilizada en IECS**]{.underline}

$$
R_0 = \left( E_{t+1} - E_t + \frac{E_t}{\lambda_E} \right) \left( \frac{\lambda_I \cdot N}{I_t \cdot S_t} \right)
$$

**Donde:**

-   $E_t, E_{t+1}$: n√∫mero de expuestos en d√≠as consecutivos\
-   $\lambda_E$: duraci√≥n media del per√≠odo pre-infeccioso\
-   $\lambda_I$: duraci√≥n media del per√≠odo infeccioso\
-   $N$: poblaci√≥n total\
-   $I_t$: cantidad de infectados actuales\
-   $S_t$: cantidad de susceptibles actuales

Por ahora se mantiene la estimaci√≥n fija de R‚ÇÄ como par√°metro inicial. La opci√≥n din√°mica queda documentada como para, eventualmente, incorporar en el server y/o habilitar desde la UI.

#### IFR global vs. IFR por grupo etario

El **IFR (Infection Fatality Rate, o tasa de fatalidad por infecci√≥n)** representa la proporci√≥n de personas infectadas que fallecen a causa de la enfermedad. A diferencia del **CFR (Case Fatality Rate)**, que se calcula s√≥lo sobre los casos detectados, el IFR intenta reflejar la letalidad real incluyendo tambi√©n los casos no detectados (asintom√°ticos, no testeados, etc.).

-   En modelos b√°sicos, se suele usar un valor **global fijo** (por ejemplo, 0.01 o 1%).
-   En modelos m√°s complejos, el IFR se puede segmentar por grupo etario.

Actualmente se usa un IFR global como valor por defecto en el modelo (0.01).

------------------------------------------------------------------------

## üè• Par√°metros de Recursos Sanitarios

### Par√°metros base

| Par√°metro | Valor inicial | Fuente o justificaci√≥n | Decisi√≥n actual |
|----|----|----|----|
| Tasa de infectados que requieren UCI (`ICU_RATE`) | 0.136 | [Estimaci√≥n IECS adaptada a Argentina (13,6%)](https://www.iecs.org.ar/wp-content/uploads/Modelo-epi-y-eval-econ_para-web.pdf) | Ajustable por UI |
| Tasa de infectados que requieren ventilador (`VENTILATOR_RATE`) | 0.02 | [Estimaci√≥n conservadora en base a estudios internacionales](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0246318) (2-3% de infectados totales) | Ajustable por UI |
| Estad√≠a hospitalaria promedio (`HOSPITAL_STAY_DAYS`) | 10 d√≠as | [Modelo IECS, en base a datos publicados por CDC](https://www.iecs.org.ar/wp-content/uploads/Modelo-epi-y-eval-econ_para-web.pdf) | Default |
| Capacidad inicial de camas UCI (`ICU_CAPACITY`) | 6000 | [Estimaci√≥n basada en SATI](https://www.scielo.org.ar/scielo.php?script=sci_arttext&pid=S0025-76802022000100035) | Ajustable por UI |
| Disponibilidad inicial de ventiladores (`VENTILATOR_AVAILABILITY`) | 2000 | [Estimaci√≥n basada en SATI](https://www.scielo.org.ar/scielo.php?script=sci_arttext&pid=S0025-76802022000100035) | Ajustable por UI |
| Personal de salud inicial (`HEALTHCARE_STAFF`) | 10.000 | Valor acotado para simular personal directamente vinculado a atenci√≥n COVID-19 en escenarios cr√≠ticos. [Se estima que Argentina tiene \~1.2M trabajadores en salud en total (en todas las funciones)](https://ri.conicet.gov.ar/bitstream/handle/11336/161336/CONICET_Digital_Nro.9508fef7-fcb8-4e0e-9bcd-8c593177d630_A.pdf?sequence=2) | Ajustable por UI |

------------------------------------------------------------------------

## üîÑ Din√°mica del Modelo SEIR

El m√≥dulo `mod_model.R` define las ecuaciones diferenciales ordinarias (EDOs) que rigen el modelo SEIR. La poblaci√≥n se divide en cuatro compartimentos:

-   S (Susceptibles)
-   E (Expuestos)
-   I (Infectados)
-   R (Recuperados)

### üî¢ Ecuaciones utilizadas:

$$
\begin{aligned}
\frac{dS}{dt} &= - \beta \cdot \frac{S \cdot I}{N} \\
\frac{dE}{dt} &= \beta \cdot \frac{S \cdot I}{N} - \sigma \cdot E \\
\frac{dI}{dt} &= \sigma \cdot E - \gamma \cdot I \\
\frac{dR}{dt} &= \gamma \cdot I
\end{aligned}
$$

Donde:

-   $N$ = Poblaci√≥n total

-   $\beta = \frac{R_0}{\gamma}$ = tasa de infecci√≥n

-   $\sigma = \frac{1}{\lambda_E}$ = tasa de progresi√≥n de incubaci√≥n

-   $\gamma = \frac{1}{\lambda_I}$ = tasa de recuperaci√≥n

\

Esta versi√≥n del modelo puede, eventualmente, segmentarse por severidad (leve, severo, cr√≠tico) o por grupos etarios.

------------------------------------------------------------------------

\

### üß† C√°lculo de R‚ÇÄ efectivo

-   `effective_R0`: Se implementa una reducci√≥n simplificada de R‚ÇÄ basada en pol√≠tica sanitaira. Por ejemplo, frente a un nivel de cumplimiento del 100%, el R‚ÇÄ se reduce en un 50.

### üßÆ Resoluci√≥n del sistema SEIR: Se utiliza deSolve::ode() para integrar el sistema de ecuaciones diferenciales, con:

-   initial_state: valores de S, E, I, R al tiempo cero

-   parameters: conjunto de par√°metros claves (effective_R0, incubation_period, infectious_period)

-   times: vector de tiempos extra√≠do desde raw_data_df()

### üìä Resultados del modelo

Se construye un results_df con:

-   Casos diarios (Daily_New_Infections) y acumulados (Cumulative_Cases)

-   Muertes simuladas (Daily_Deaths, Cumulative_Deaths) usando IFR

-   Demanda diaria de recursos cr√≠ticos:

    -   ICU_Daily_Demand = I √ó tasa_UCI

    -   Vent_Daily_Demand = I √ó tasa_ventilador

-   Simulaci√≥n de ocupaci√≥n por rolling sum:

    -   ICU_Occupancy_Sim = acumulado en ventana m√≥vil de hospital_stay_days

    -   Vent_Usage_Sim = idem para ventiladores

\
‚ö†Ô∏è Este c√°lculo es una simplificaci√≥n. Un modelo m√°s avanzado podr√≠a incorporar retrasos (lag), colas (queueing models) o tiempos individuales de atenci√≥n.

\
üìå Decisiones clave

-   Las variables de capacidad (icu_capacity, ventilator_availability) se manejan por separado en el m√≥dulo de visualizaci√≥n.

-   La saturaci√≥n de recursos se eval√∫a comparando ICU_Occupancy_Sim vs. capacidad.

-   Todos los par√°metros son ajustables desde UI, lo que permite simular distintos escenarios sanitarios.

\
üîÅ Mejoras posibles

-   Modelar contagio entre segmentos (edad, severidad).

-   Agregar compartimentos cl√≠nicos: hospitalizado, cr√≠tico, fallecido.

-   Incorporar grupos geogr√°ficos.

------------------------------------------------------------------------

## üß† Arquitectura del m√≥dulo `mod_server.R`

Este m√≥dulo centraliza la l√≥gica de la app Shiny. Su funci√≥n es orquestar la interacci√≥n entre:

-   Inputs del usuario (`input`)
-   Par√°metros internos (`app_params`)
-   M√≥dulos de simulaci√≥n (`data_sim`, `seir_model`)
-   M√≥dulo de visualizaci√≥n (`main_viz`)

------------------------------------------------------------------------

## üß¨ M√≥dulo `mod_data.R`: Inicializaci√≥n de Datos

Este m√≥dulo simula la ingesta de datos epidemiol√≥gicos y genera una estructura est√°ndar para la simulaci√≥n del modelo SEIR.

------------------------------------------------------------------------

### üî¢ Estado inicial simulado

Se simula una poblaci√≥n inicial mayormente susceptible, con 10.000 individuos ya infectados. Este dummy_data se pasa al m√≥dulo model_seir_server como raw_data_df

El modelo lee los valores iniciales (S, E, I, R) desde el d√≠a time == 0

El resto de las columnas son sobrescritas por el resultado del modelo

### üìÅ Futuras extensiones

En lugar de generar datos simulados, el m√≥dulo podr√≠a:

-   Leer archivos .csv, .xlsx con datos reales

-   Consultar una API (p.ej., datos.gob.ar)

-   Aplicar l√≥gica de limpieza / imputaci√≥n de datos para calibrar el modelo

### ‚úçÔ∏è Decisi√≥n actual

Se mantiene la estructura simulada para el prototipo, asegurando compatibilidad con el modelo SEIR. El m√≥dulo est√° preparado para integrar datos reales en versiones posteriores.\

------------------------------------------------------------------------

## üìä M√≥dulo `mod_viz.R`: Gr√°ficos Interactivos

Este m√≥dulo renderiza tres visualizaciones basadas en los datos simulados por el modelo SEIR. Todas se actualizan din√°micamente al cambiar los par√°metros o al ejecutar una nueva simulaci√≥n.

------------------------------------------------------------------------

### 1Ô∏è‚É£ Din√°mica SEIR (`seir_plot`)

Visualiza la evoluci√≥n temporal de los cuatro compartimentos del modelo:

| Compartimento    | Color    | Descripci√≥n                  |
|------------------|----------|------------------------------|
| S (Susceptibles) | Verde    | Personas a√∫n no infectadas   |
| E (Expuestos)    | Amarillo | Personas incubando el virus  |
| I (Infectados)   | Rojo     | Personas que contagian       |
| R (Recuperados)  | Azul     | Personas que ya no contagian |

------------------------------------------------------------------------

### 2Ô∏è‚É£ Casos y Muertes Acumuladas (`cases_deaths_plot`)

| M√©trica            | Color   | Descripci√≥n                       |
|--------------------|---------|-----------------------------------|
| Casos acumulados   | Naranja | Suma de nuevas infecciones        |
| Muertes acumuladas | Gris    | Suma de muertes simuladas por IFR |

-   Gr√°fico de l√≠neas con acumulativos
-   Permite monitorear evoluci√≥n de impacto total

------------------------------------------------------------------------

### 3Ô∏è‚É£ Presi√≥n sobre Recursos Cr√≠ticos (`resource_pressure_plot`)

| M√©trica | L√≠nea | √Årea sombreada | Color |
|----|----|----|----|
| Demanda UCI | S√≥lida | Cuando excede capacidad | Rojo |
| Capacidad UCI | Punteada | L√≠nea de referencia | Celeste |
| Demanda Ventiladores | S√≥lida | Cuando excede capacidad | Rojo |
| Capacidad Vent. | Punteada | L√≠nea de referencia | Celeste |
| Exceso de demanda | √Årea bajo `geom_ribbon()` | Rosa p√°lido |  |

-   Comparaci√≥n diaria entre demanda simulada y capacidad ingresada por usuario
-   `geom_ribbon()` destaca d√≠as donde la demanda supera la capacidad

------------------------------------------------------------------------

### üîÅ Reactividad

-   Cada gr√°fico se actualiza autom√°ticamente si:
    -   Se ejecuta una nueva simulaci√≥n (`trigger_sim`)

    -   Se modifican los inputs de capacidad (`ICU`, `Ventiladores`)

------------------------------------------------------------------------

### üß† Mejoras futuras

-   Agregar visualizaci√≥n de saturaci√≥n del personal de salud
-   Incorporar comparaciones entre escenarios
-   Permitir zoom interactivo (e.g., `plotly` o `ggiraph`)

## üñ•Ô∏è M√≥dulo `mod_ui.R`: Interfaz de Usuario

Este m√≥dulo define la UI del tablero epidemiol√≥gico en Shiny, agrupando controles por tipo de par√°metro y renderizando las visualizaciones principales en pesta√±as.

------------------------------------------------------------------------

### üîß Estructura modular

| Funci√≥n                | Descripci√≥n                                    |
|------------------------|------------------------------------------------|
| `ui_seir_params()`     | Controles para par√°metros del modelo SEIR      |
| `ui_policy_params()`   | Controles para par√°metros de intervenci√≥n      |
| `ui_resource_params()` | Controles para par√°metros de recursos cr√≠ticos |
| `ui_main()`            | Define la disposici√≥n general del tablero      |

------------------------------------------------------------------------

### 1Ô∏è‚É£ Par√°metros SEIR

Incluye sliders para:

-   `R‚ÇÄ` (transmisibilidad inicial)
-   Per√≠odo de incubaci√≥n (`Œª_E`)
-   Per√≠odo infeccioso (`Œª_I`)
-   Tasa de letalidad por infecci√≥n (`IFR`)

> Cada control est√° inicializado con los valores definidos en `global.R`, facilitando ajuste por parte del usuario.

------------------------------------------------------------------------

### 2Ô∏è‚É£ Pol√≠ticas p√∫blicas

-   `policy_type`: selector con cuatro estrategias
    -   Sin intervenci√≥n
    -   Mitigaci√≥n por fases
    -   Intervenci√≥n intermitente
    -   Activaci√≥n gatillada por saturaci√≥n UTI
-   `compliance_level`: slider con cumplimiento en porcentaje

üóíÔ∏è Estos valores afectan el c√°lculo de `effective_R0` en el m√≥dulo de modelo.

------------------------------------------------------------------------

### 3Ô∏è‚É£ Recursos cr√≠ticos

Inputs num√©ricos para definir:

-   Capacidad de UCI
-   Disponibilidad de respiradores
-   Personal de salud disponible

Sliders para tasas de utilizaci√≥n:

-   Tasa de ingreso a UCI (sobre infectados)
-   Tasa de uso de respiradores (sobre infectados)

üìå Todos estos par√°metros impactan en el c√°lculo de presi√≥n sanitaria (`ICU_Occupancy_Sim`, `Vent_Usage_Sim`).

------------------------------------------------------------------------
